<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡∏£‡∏ß‡∏à‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô Pre-test ‡∏™‡∏ï‡∏£‡∏µ‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤ 2569</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Thai:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        body {
            font-family: 'Noto Sans Thai', sans-serif;
            background-color: #f7f8fc;
        }
        .header-gradient {
            background-image: linear-gradient(135deg, #2a2a72 0%, #009ffd 100%);
        }
        .input-field {
            border-radius: 0.5rem;
            padding: 0.75rem 1rem;
            border: 1px solid #d1d5db;
            transition: border-color 0.2s, box-shadow 0.2s;
            background-color: #f9fafb;
        }
        .input-field:focus {
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);
            outline: none;
        }
        .btn {
            border-radius: 0.5rem;
            transition: all 0.2s ease;
            color: white;
            font-weight: 600;
            padding: 0.75rem 1.5rem;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            border: none;
            cursor: pointer;
        }
        .btn-primary {
            background-image: linear-gradient(to right, #3b82f6, #60a5fa);
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 7px 20px rgba(59, 130, 246, 0.2);
        }
        .btn-danger {
            background-image: linear-gradient(to right, #dc2626, #ef4444);
        }
        .btn-danger:hover {
            transform: translateY(-2px);
            box-shadow: 0 7px 20px rgba(220, 38, 38, 0.2);
        }
        .curriculum-option {
            border: 2px solid #e5e7eb;
            border-radius: 0.75rem;
            padding: 1rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        .curriculum-option.selected {
            border-color: #3b82f6;
            background-color: #eff6ff;
        }
        .line-opc-section {
            background: linear-gradient(135deg, #06c755 0%, #00b34c 100%);
            border-radius: 1rem;
            padding: 1.5rem;
            margin-top: 2rem;
            color: white;
            text-align: center;
            box-shadow: 0 10px 25px rgba(6, 199, 85, 0.2);
        }
        .line-opc-button {
            display: inline-flex;
            align-items: center;
            background: white;
            color: #06c755;
            padding: 0.75rem 1.5rem;
            border-radius: 2rem;
            font-weight: 600;
            text-decoration: none;
            margin-top: 1rem;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        .line-opc-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 7px 20px rgba(0, 0, 0, 0.15);
            color: #06c755;
        }
        .hidden {
            display: none;
        }
        .score-input-section {
            background: #f8f9fa;
            border-radius: 0.75rem;
            padding: 1.5rem;
            margin-top: 1rem;
        }
        .exam-type-option {
            border: 2px solid #e5e7eb;
            border-radius: 0.75rem;
            padding: 1rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        .exam-type-option.selected {
            border-color: #3b82f6;
            background-color: #eff6ff;
        }
        .success-message {
            background: #d1fae5;
            border: 1px solid #a7f3d0;
            color: #065f46;
            padding: 2rem;
            border-radius: 1rem;
            text-align: center;
            margin: 2rem 0;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body class="p-4 sm:p-6">
    <!-- Message Box -->
    <div id="message-box" class="fixed top-5 right-5 z-50 w-full max-w-sm"></div>
    
    <!-- Header -->
    <div class="max-w-7xl mx-auto text-center py-3 mb-4 bg-pink-100 rounded-xl shadow-md border-2 border-pink-300">
        <h2 class="text-2xl font-extrabold text-pink-700 tracking-wider">
            ‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß‡∏¢‡∏≠‡∏î‡∏ô‡∏≤‡∏£‡∏µ ‚ù§Ô∏è ‡∏™‡∏ï‡∏£‡∏µ‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤
        </h2>
    </div>
    
    <!-- Main Content -->
    <div class="max-w-7xl mx-auto bg-white rounded-2xl shadow-xl overflow-hidden">
        <header class="text-center p-8 sm:p-10 header-gradient relative">
            <h1 class="text-3xl sm:text-4xl font-extrabold text-white leading-tight">
                ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡∏£‡∏ß‡∏à‡πÅ‡∏•‡∏∞‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô Pre-test ‡∏™‡∏ï‡∏£‡∏µ‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤
            </h1>
            <p class="text-lg text-blue-200 mt-2">‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ 2569</p>
        </header>
        
        <main class="p-6 sm:p-8">
            <!-- Success Message -->
            <div id="success-message" class="success-message hidden">
                <i class="fas fa-check-circle text-4xl mb-4 text-green-600"></i>
                <h3 class="text-2xl font-bold mb-4">‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! üéâ</h3>
                <p class="mb-4 text-lg">‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏£‡πà‡∏ß‡∏°‡πÅ‡∏ö‡πà‡∏á‡∏õ‡∏±‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô üôè</p>
                <p class="mb-6">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö Google Forms ‡πÅ‡∏•‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡∏ô‡πâ‡∏≠‡∏á‡πÜ ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏´‡πá‡∏ô‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</p>
                <div class="flex justify-center space-x-4">
                    <button onclick="resetForm()" class="btn btn-primary">
                        <i class="fas fa-plus mr-2"></i> ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°
                    </button>
                    <button onclick="viewGoogleForm()" class="btn" style="background-image: linear-gradient(to right, #4285f4, #34a853);">
                        <i class="fab fa-google mr-2"></i> ‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô Google Forms
                    </button>
                </div>
            </div>
            
            <!-- Form Section -->
            <div id="form-section">
                <form id="survey-form" class="space-y-8 max-w-4xl mx-auto">
                    <!-- ‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô -->
                    <div>
                        <label for="nickname" class="block text-gray-700 font-semibold mb-2">‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô / ‡∏ô‡∏≤‡∏°‡πÅ‡∏ù‡∏á (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)</label>
                        <input type="text" id="nickname" class="input-field w-full" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏ô‡πâ‡∏≠‡∏á‡∏¢‡∏≠‡∏î‡∏ô‡∏≤‡∏£‡∏µ">
                    </div>
                    
                    <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 1: ‡πÅ‡∏ö‡∏ö‡∏™‡∏≥‡∏£‡∏ß‡∏à‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏≠‡∏ö Pre-test -->
                    <div class="border rounded-lg p-6 bg-gray-50">
                        <h3 class="font-semibold text-lg text-gray-800 mb-4">‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 1: ‡πÅ‡∏ö‡∏ö‡∏™‡∏≥‡∏£‡∏ß‡∏à‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏≠‡∏ö Pre-test</h3>
                        
                        <div class="mb-6">
                            <label class="block text-gray-700 font-semibold mb-3">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£‡∏ó‡∏µ‡πà‡∏™‡∏≠‡∏ö Pre-test</label>
                            <div class="space-y-3">
                                <label class="curriculum-option flex items-center">
                                    <input type="radio" name="pretestCurriculum" value="special" class="mr-3" onchange="toggleExamTypeSelection()">
                                    <div>
                                        <span class="font-medium">‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏©</span>
                                        <p class="text-sm text-gray-600 mt-1">‡∏™‡∏≠‡∏ö 3 ‡∏ß‡∏¥‡∏ä‡∏≤: ‡∏Ñ‡∏ì‡∏¥‡∏ï 50 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô, ‡∏ß‡∏¥‡∏ó‡∏¢‡πå 30 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô, English 30 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</p>
                                    </div>
                                </label>
                                <label class="curriculum-option flex items-center">
                                    <input type="radio" name="pretestCurriculum" value="normal" class="mr-3" onchange="toggleExamTypeSelection()">
                                    <div>
                                        <span class="font-medium">‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥</span>
                                        <p class="text-sm text-gray-600 mt-1">‡∏™‡∏≠‡∏ö 5 ‡∏ß‡∏¥‡∏ä‡∏≤: ‡∏Ñ‡∏ì‡∏¥‡∏ï 30, ‡∏ß‡∏¥‡∏ó‡∏¢‡πå 30, English 30, ‡πÑ‡∏ó‡∏¢ 30, ‡∏™‡∏±‡∏á‡∏Ñ‡∏° 30 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</p>
                                    </div>
                                </label>
                                <label class="curriculum-option flex items-center">
                                    <input type="radio" name="pretestCurriculum" value="both" class="mr-3" onchange="toggleExamTypeSelection()">
                                    <div>
                                        <span class="font-medium">‡∏™‡∏≠‡∏ö‡∏ó‡∏±‡πâ‡∏á 2 ‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£</span>
                                        <p class="text-sm text-gray-600 mt-1">‡∏™‡∏≠‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏©‡πÅ‡∏•‡∏∞‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥</p>
                                    </div>
                                </label>
                            </div>
                        </div>
                        
                        <!-- ‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ö -->
                        <div id="exam-type-selection" class="mb-6">
                            <label class="block text-gray-700 font-semibold mb-3">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ö</label>
                            <div class="space-y-3">
                                <!-- ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏© -->
                                <div id="special-exam-type" class="hidden">
                                    <label class="block text-gray-700 mb-2">‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏©</label>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                                        <label class="exam-type-option flex items-center">
                                            <input type="radio" name="specialExamType" value="On-site" class="mr-3" required>
                                            <div>
                                                <span class="font-medium">On-site</span>
                                                <p class="text-sm text-gray-600 mt-1">‡∏™‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</p>
                                            </div>
                                        </label>
                                        <label class="exam-type-option flex items-center">
                                            <input type="radio" name="specialExamType" value="Online" class="mr-3" required>
                                            <div>
                                                <span class="font-medium">Online</span>
                                                <p class="text-sm text-gray-600 mt-1">‡∏™‡∏≠‡∏ö‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå</p>
                                            </div>
                                        </label>
                                    </div>
                                </div>
                                
                                <!-- ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥ -->
                                <div id="normal-exam-type" class="hidden">
                                    <label class="block text-gray-700 mb-2">‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥</label>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                                        <label class="exam-type-option flex items-center">
                                            <input type="radio" name="normalExamType" value="On-site" class="mr-3" required>
                                            <div>
                                                <span class="font-medium">On-site</span>
                                                <p class="text-sm text-gray-600 mt-1">‡∏™‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</p>
                                            </div>
                                        </label>
                                        <label class="exam-type-option flex items-center">
                                            <input type="radio" name="normalExamType" value="Online" class="mr-3" required>
                                            <div>
                                                <span class="font-medium">Online</span>
                                                <p class="text-sm text-gray-600 mt-1">‡∏™‡∏≠‡∏ö‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå</p>
                                            </div>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏Å‡∏£‡∏≠‡∏Å‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô Pre-test -->
                    <div id="score-inputs-container">
                        <!-- ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏© -->
                        <div id="special-scores-section" class="score-input-section hidden">
                            <h3 class="font-semibold text-lg text-gray-800 mb-4">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏©</h3>
                            
                            <!-- ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö -->
                            <div class="mb-6">
                                <label for="special_rank" class="block text-gray-700 font-semibold mb-2">‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ</label>
                                <input type="number" id="special_rank" class="input-field w-full md:w-48" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö" min="1" required>
                            </div>
                            
                            <!-- ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ß‡∏¥‡∏ä‡∏≤ -->
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                                <div>
                                    <label for="score_special_math" class="block text-gray-700 font-semibold mb-2">‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå</label>
                                    <div class="relative">
                                        <input type="number" id="score_special_math" class="input-field w-full pr-16" placeholder="0.00" min="0" max="50" step="0.01" required>
                                        <span class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500">/50</span>
                                    </div>
                                </div>
                                <div>
                                    <label for="score_special_science" class="block text-gray-700 font-semibold mb-2">‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå</label>
                                    <div class="relative">
                                        <input type="number" id="score_special_science" class="input-field w-full pr-16" placeholder="0.00" min="0" max="30" step="0.01" required>
                                        <span class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500">/30</span>
                                    </div>
                                </div>
                                <div>
                                    <label for="score_special_english" class="block text-gray-700 font-semibold mb-2">‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©</label>
                                    <div class="relative">
                                        <input type="number" id="score_special_english" class="input-field w-full pr-16" placeholder="0.00" min="0" max="30" step="0.01" required>
                                        <span class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500">/30</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏° -->
                            <div class="bg-blue-50 p-4 rounded-lg">
                                <div class="flex justify-between items-center">
                                    <span class="font-semibold text-gray-700">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°:</span>
                                    <span id="special-total-score" class="text-2xl font-bold text-blue-600">0.00</span>
                                </div>
                            </div>
                        </div>

                        <!-- ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥ -->
                        <div id="normal-scores-section" class="score-input-section hidden">
                            <h3 class="font-semibold text-lg text-gray-800 mb-4">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥</h3>
                            
                            <!-- ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö -->
                            <div class="mb-6">
                                <label for="normal_rank" class="block text-gray-700 font-semibold mb-2">‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ</label>
                                <input type="number" id="normal_rank" class="input-field w-full md:w-48" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö" min="1" required>
                            </div>
                            
                            <!-- ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ß‡∏¥‡∏ä‡∏≤ -->
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                                <div>
                                    <label for="score_normal_math" class="block text-gray-700 font-semibold mb-2">‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå</label>
                                    <div class="relative">
                                        <input type="number" id="score_normal_math" class="input-field w-full pr-16" placeholder="0.00" min="0" max="30" step="0.01" required>
                                        <span class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500">/30</span>
                                    </div>
                                </div>
                                <div>
                                    <label for="score_normal_science" class="block text-gray-700 font-semibold mb-2">‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå</label>
                                    <div class="relative">
                                        <input type="number" id="score_normal_science" class="input-field w-full pr-16" placeholder="0.00" min="0" max="30" step="0.01" required>
                                        <span class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500">/30</span>
                                    </div>
                                </div>
                                <div>
                                    <label for="score_normal_english" class="block text-gray-700 font-semibold mb-2">‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©</label>
                                    <div class="relative">
                                        <input type="number" id="score_normal_english" class="input-field w-full pr-16" placeholder="0.00" min="0" max="30" step="0.01" required>
                                        <span class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500">/30</span>
                                    </div>
                                </div>
                                <div>
                                    <label for="score_normal_thai" class="block text-gray-700 font-semibold mb-2">‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢</label>
                                    <div class="relative">
                                        <input type="number" id="score_normal_thai" class="input-field w-full pr-16" placeholder="0.00" min="0" max="30" step="0.01" required>
                                        <span class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500">/30</span>
                                    </div>
                                </div>
                                <div>
                                    <label for="score_normal_social" class="block text-gray-700 font-semibold mb-2">‡∏™‡∏±‡∏á‡∏Ñ‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤</label>
                                    <div class="relative">
                                        <input type="number" id="score_normal_social" class="input-field w-full pr-16" placeholder="0.00" min="0" max="30" step="0.01" required>
                                        <span class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500">/30</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏° -->
                            <div class="bg-green-50 p-4 rounded-lg">
                                <div class="flex justify-between items-center">
                                    <span class="font-semibold text-gray-700">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°:</span>
                                    <span id="normal-total-score" class="text-2xl font-bold text-green-600">0.00</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 2: ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤ -->
                    <div class="border rounded-lg p-6 bg-gray-50">
                        <h3 class="font-semibold text-lg text-gray-800 mb-4">‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 2: ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤</h3>
                        
                        <!-- ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏© -->
                        <div id="target-special-section" class="mb-6 hidden">
                            <label class="block text-gray-700 font-semibold mb-3">‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏©</label>
                            <div class="space-y-3">
                                <label class="curriculum-option flex items-center">
                                    <input type="radio" name="targetSpecial" value="EP" class="mr-3">
                                    <div>
                                        <span class="font-medium">EP (English Program)</span>
                                        <p class="text-sm text-gray-600 mt-1">‡∏™‡∏≠‡∏ö 4 ‡∏ß‡∏¥‡∏ä‡∏≤: English 80, ‡∏Ñ‡∏ì‡∏¥‡∏ï 50, ‡∏ß‡∏¥‡∏ó‡∏¢‡πå 50, ‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå 20 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô (‡πÄ‡∏ï‡πá‡∏° 200)</p>
                                    </div>
                                </label>
                                <label class="curriculum-option flex items-center">
                                    <input type="radio" name="targetSpecial" value="SMTE" class="mr-3">
                                    <div>
                                        <span class="font-medium">SMTE (Science Math Technology and Environment)</span>
                                        <p class="text-sm text-gray-600 mt-1">‡∏™‡∏≠‡∏ö 2 ‡∏ß‡∏¥‡∏ä‡∏≤: ‡∏Ñ‡∏ì‡∏¥‡∏ï 50, ‡∏ß‡∏¥‡∏ó‡∏¢‡πå 50 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô (‡πÄ‡∏ï‡πá‡∏° 100)</p>
                                    </div>
                                </label>
                                <label class="curriculum-option flex items-center">
                                    <input type="radio" name="targetSpecial" value="GM" class="mr-3">
                                    <div>
                                        <span class="font-medium">Gifted Math</span>
                                        <p class="text-sm text-gray-600 mt-1">‡∏™‡∏≠‡∏ö 3 ‡∏ß‡∏¥‡∏ä‡∏≤: ‡∏Ñ‡∏ì‡∏¥‡∏ï 50, ‡∏ß‡∏¥‡∏ó‡∏¢‡πå 50, English 10 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô (‡πÄ‡∏ï‡πá‡∏° 110)</p>
                                    </div>
                                </label>
                            </div>
                        </div>
                        
                        <!-- ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥ -->
                        <div id="target-normal-section" class="hidden">
                            <label class="block text-gray-700 font-semibold mb-3">‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥</label>
                            <div class="space-y-3">
                                <label class="curriculum-option flex items-center">
                                    <input type="radio" name="targetNormal" value="Normal_In" class="mr-3">
                                    <div>
                                        <span class="font-medium">‡πÉ‡∏ô‡πÄ‡∏Ç‡∏ï‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£</span>
                                        <p class="text-sm text-gray-600 mt-1">‡∏™‡∏≠‡∏ö 5 ‡∏ß‡∏¥‡∏ä‡∏≤: ‡∏Ñ‡∏ì‡∏¥‡∏ï 20, ‡∏ß‡∏¥‡∏ó‡∏¢‡πå 20, English 20, ‡πÑ‡∏ó‡∏¢ 20, ‡∏™‡∏±‡∏á‡∏Ñ‡∏° 20 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô (‡πÄ‡∏ï‡πá‡∏° 100)</p>
                                    </div>
                                </label>
                                <label class="curriculum-option flex items-center">
                                    <input type="radio" name="targetNormal" value="Normal_Out" class="mr-3">
                                    <div>
                                        <span class="font-medium">‡∏ô‡∏≠‡∏Å‡πÄ‡∏Ç‡∏ï‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£</span>
                                        <p class="text-sm text-gray-600 mt-1">‡∏™‡∏≠‡∏ö 5 ‡∏ß‡∏¥‡∏ä‡∏≤: ‡∏Ñ‡∏ì‡∏¥‡∏ï 20, ‡∏ß‡∏¥‡∏ó‡∏¢‡πå 20, English 20, ‡πÑ‡∏ó‡∏¢ 20, ‡∏™‡∏±‡∏á‡∏Ñ‡∏° 20 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô (‡πÄ‡∏ï‡πá‡∏° 100)</p>
                                    </div>
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="text-center pt-6 flex justify-center space-x-4">
                        <button type="submit" class="btn btn-primary text-lg">
                            <i class="fas fa-paper-plane mr-2"></i> ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏•‡∏™‡∏≥‡∏£‡∏ß‡∏à
                        </button>
                        <button type="button" id="reset-btn" class="btn btn-danger text-lg">
                            <i class="fas fa-undo mr-2"></i> ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                        </button>
                    </div>
                </form>
            </div>
        </main>
        
        <!-- Line OPC Section -->
        <div class="line-opc-section mx-6 mb-6">
            <div class="flex flex-col items-center">
                <div class="text-center mb-4">
                    <p class="text-lg font-semibold mb-2">üåü ‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡∏à‡∏±‡∏î‡∏ó‡∏≥‡πÇ‡∏î‡∏¢ ... ‡∏•‡∏∏‡πâ‡∏ô‡∏™‡∏≠‡∏ß‡∏≠‡πÑ‡∏õ‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏±‡∏ô‡∏ô‡∏∞ üåü</p>
                    <p class="text-xl font-bold">‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß‡∏¢‡∏≠‡∏î‡∏ô‡∏≤‡∏£‡∏µ‚ù§Ô∏è‡∏™‡∏ï‡∏£‡∏µ‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤</p>
                </div>
                <a href="https://line.me/ti/g2/ZRIN-ofnybH08hXhS6OYTfIMeKqvupT0Qzd44Q?utm_source=invitation&utm_medium=link_copy&utm_campaign=default" 
                   target="_blank" class="line-opc-button">
                    <i class="fab fa-line mr-2 text-xl"></i>
                    Line OPC
                </a>
                <p class="text-sm mt-3 opacity-90">‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÑ‡∏•‡∏ô‡πå‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß‡∏¢‡∏≠‡∏î‡∏ô‡∏≤‡∏£‡∏µ</p>
            </div>
        </div>
    </div>
    
    <footer class="text-center py-6 text-gray-500 text-sm">
        <p>Developed for Satriwitthaya Pre-test Takers | ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏ô Google Forms</p>
    </footer>

    <!-- Google Form Integration -->
    <script>
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á/‡∏ã‡πà‡∏≠‡∏ô‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏ß‡∏ô‡∏Å‡∏£‡∏≠‡∏Å‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô
        function toggleExamTypeSelection() {
            const selectedCurriculum = document.querySelector('input[name="pretestCurriculum"]:checked');
            if (!selectedCurriculum) return;
            
            const selectedValue = selectedCurriculum.value;
            const specialExamType = document.getElementById('special-exam-type');
            const normalExamType = document.getElementById('normal-exam-type');
            const specialScoresSection = document.getElementById('special-scores-section');
            const normalScoresSection = document.getElementById('normal-scores-section');
            const targetSpecialSection = document.getElementById('target-special-section');
            const targetNormalSection = document.getElementById('target-normal-section');
            
            // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ñ‡πà‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Å‡πà‡∏≠‡∏ô
            specialExamType.classList.add('hidden');
            normalExamType.classList.add('hidden');
            specialScoresSection.classList.add('hidden');
            normalScoresSection.classList.add('hidden');
            targetSpecialSection.classList.add('hidden');
            targetNormalSection.classList.add('hidden');
            
            // ‡∏•‡πâ‡∏≤‡∏á‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
            document.querySelectorAll('input[name="specialExamType"]').forEach(input => input.checked = false);
            document.querySelectorAll('input[name="normalExamType"]').forEach(input => input.checked = false);
            document.querySelectorAll('input[name="targetSpecial"]').forEach(input => input.checked = false);
            document.querySelectorAll('input[name="targetNormal"]').forEach(input => input.checked = false);
            
            if (selectedValue === 'both') {
                specialExamType.classList.remove('hidden');
                normalExamType.classList.remove('hidden');
                specialScoresSection.classList.remove('hidden');
                normalScoresSection.classList.remove('hidden');
                targetSpecialSection.classList.remove('hidden');
                targetNormalSection.classList.remove('hidden');
            } else if (selectedValue === 'special') {
                specialExamType.classList.remove('hidden');
                specialScoresSection.classList.remove('hidden');
                targetSpecialSection.classList.remove('hidden');
            } else if (selectedValue === 'normal') {
                normalExamType.classList.remove('hidden');
                normalScoresSection.classList.remove('hidden');
                targetNormalSection.classList.remove('hidden');
            }
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
        function setupAutoCalculate() {
            // ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏©
            const specialInputs = ['score_special_math', 'score_special_science', 'score_special_english'];
            specialInputs.forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.addEventListener('input', calculateSpecialTotal);
                }
            });

            // ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥
            const normalInputs = ['score_normal_math', 'score_normal_science', 'score_normal_english', 'score_normal_thai', 'score_normal_social'];
            normalInputs.forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.addEventListener('input', calculateNormalTotal);
                }
            });
        }

        function calculateSpecialTotal() {
            const math = parseFloat(document.getElementById('score_special_math').value) || 0;
            const science = parseFloat(document.getElementById('score_special_science').value) || 0;
            const english = parseFloat(document.getElementById('score_special_english').value) || 0;
            const total = math + science + english;
            document.getElementById('special-total-score').textContent = total.toFixed(2);
        }

        function calculateNormalTotal() {
            const math = parseFloat(document.getElementById('score_normal_math').value) || 0;
            const science = parseFloat(document.getElementById('score_normal_science').value) || 0;
            const english = parseFloat(document.getElementById('score_normal_english').value) || 0;
            const thai = parseFloat(document.getElementById('score_normal_thai').value) || 0;
            const social = parseFloat(document.getElementById('score_normal_social').value) || 0;
            const total = math + science + english + thai + social;
            document.getElementById('normal-total-score').textContent = total.toFixed(2);
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏ü‡∏≠‡∏£‡πå‡∏°
        function resetForm() {
            document.getElementById('survey-form').reset();
            document.getElementById('special-scores-section').classList.add('hidden');
            document.getElementById('normal-scores-section').classList.add('hidden');
            document.getElementById('special-exam-type').classList.add('hidden');
            document.getElementById('normal-exam-type').classList.add('hidden');
            document.getElementById('target-special-section').classList.add('hidden');
            document.getElementById('target-normal-section').classList.add('hidden');
            document.getElementById('special-total-score').textContent = '0.00';
            document.getElementById('normal-total-score').textContent = '0.00';
            document.getElementById('success-message').classList.add('hidden');
            document.getElementById('form-section').classList.remove('hidden');
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏õ‡∏¥‡∏î Google Form
        function viewGoogleForm() {
            window.open('https://forms.gle/GktYv7PzQ7tsjbBy9', '_blank');
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
        function showMessage(message, type = 'success') {
            const box = document.getElementById('message-box');
            const colors = { success: 'green', error: 'red', warning: 'yellow' };
            const icons = { 
                success: 'fa-check-circle', 
                error: 'fa-times-circle', 
                warning: 'fa-exclamation-triangle' 
            };
            
            const alertDiv = document.createElement('div');
            alertDiv.className = `p-4 rounded-lg shadow-lg mb-2 bg-${colors[type]}-100 border-l-4 border-${colors[type]}-500 text-${colors[type]}-800 transition-all duration-300 transform translate-x-full opacity-0`;
            alertDiv.innerHTML = `<i class="fas ${icons[type]} mr-2"></i> <span class="font-semibold">${message}</span>`;
            
            box.prepend(alertDiv);
            
            setTimeout(() => alertDiv.classList.remove('translate-x-full', 'opacity-0'), 10);
            
            setTimeout(() => {
                alertDiv.classList.add('opacity-0');
                setTimeout(() => alertDiv.remove(), 400);
            }, 5000);
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á Google Form
        function submitToGoogleForm(formData) {
            // ‡πÉ‡∏ä‡πâ URL Google Form ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
            const googleFormURL = 'https://docs.google.com/forms/d/e/1FAIpQLScloDITkx1WmkfZDPV975qSMaGboSMsBtlobCZ09O63nxyAYA/formResponse';
            
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á iframe ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
            const iframe = document.createElement('iframe');
            iframe.name = 'google-form-submit';
            iframe.style.display = 'none';
            document.body.appendChild(iframe);
            
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á form ‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
            const tempForm = document.createElement('form');
            tempForm.action = googleFormURL;
            tempForm.method = 'POST';
            tempForm.target = 'google-form-submit';
            tempForm.style.display = 'none';
            
            // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ü‡∏¥‡∏•‡∏î‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á‡πÉ‡∏ô form
            Object.keys(formData).forEach(key => {
                if (formData[key]) { // ‡∏™‡πà‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                    const input = document.createElement('input');
                    input.type = 'hidden';
                    input.name = key;
                    input.value = formData[key];
                    tempForm.appendChild(input);
                }
            });
            
            document.body.appendChild(tempForm);
            tempForm.submit();
            
            // ‡∏•‡πâ‡∏≤‡∏á form ‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏™‡πà‡∏á
            setTimeout(() => {
                document.body.removeChild(tempForm);
                document.body.removeChild(iframe);
            }, 1000);
            
            return true;
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°
        function handleFormSubmit(e) {
            e.preventDefault();
            
            // ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏ü‡∏≠‡∏£‡πå‡∏°
            const nickname = document.getElementById('nickname').value.trim() || '‡πÑ‡∏°‡πà‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡∏≠‡∏≠‡∏Å‡∏ô‡∏≤‡∏°';
            const pretestCurriculum = document.querySelector('input[name="pretestCurriculum"]:checked');
            
            if (!pretestCurriculum) {
                showMessage('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£‡∏ó‡∏µ‡πà‡∏™‡∏≠‡∏ö Pre-test', 'error');
                return;
            }
            
            const pretestCurriculumValue = pretestCurriculum.value;
            const targetSpecial = document.querySelector('input[name="targetSpecial"]:checked')?.value || '';
            const targetNormal = document.querySelector('input[name="targetNormal"]:checked')?.value || '';
            
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô
            let isValid = true;
            let errorMessage = '';
            
            if (pretestCurriculumValue === 'special' || pretestCurriculumValue === 'both') {
                const specialExamType = document.querySelector('input[name="specialExamType"]:checked');
                const specialRank = document.getElementById('special_rank').value;
                const specialMath = document.getElementById('score_special_math').value;
                
                if (!specialExamType) {
                    isValid = false;
                    errorMessage = '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ö‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏©';
                } else if (!specialRank || !specialMath) {
                    isValid = false;
                    errorMessage = '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏©‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô';
                }
            }
            
            if (pretestCurriculumValue === 'normal' || pretestCurriculumValue === 'both') {
                const normalExamType = document.querySelector('input[name="normalExamType"]:checked');
                const normalRank = document.getElementById('normal_rank').value;
                const normalMath = document.getElementById('score_normal_math').value;
                
                if (!normalExamType) {
                    isValid = false;
                    errorMessage = '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ö‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥';
                } else if (!normalRank || !normalMath) {
                    isValid = false;
                    errorMessage = '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô';
                }
            }
            
            if (!isValid) {
                showMessage(errorMessage, 'error');
                return;
            }
            
            // ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏¢‡∏±‡∏á Google Form
            const formData = {
                // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô
                'entry.2144888210': nickname, // ‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô
                'entry.135880921': pretestCurriculumValue, // ‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£‡∏ó‡∏µ‡πà‡∏™‡∏≠‡∏ö
                
                // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏©
                'entry.2009803169': document.querySelector('input[name="specialExamType"]:checked')?.value || '', // ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏™‡∏≠‡∏ö‡∏û‡∏¥‡πÄ‡∏®‡∏©
                'entry.1291462508': document.getElementById('special_rank')?.value || '', // ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö‡∏û‡∏¥‡πÄ‡∏®‡∏©
                'entry.108602341': document.getElementById('score_special_math')?.value || '', // ‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏û‡∏¥‡πÄ‡∏®‡∏©
                'entry.1372184360': document.getElementById('score_special_science')?.value || '', // ‡∏ß‡∏¥‡∏ó‡∏¢‡πå‡∏û‡∏¥‡πÄ‡∏®‡∏©
                'entry.2138949640': document.getElementById('score_special_english')?.value || '', // ‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©‡∏û‡∏¥‡πÄ‡∏®‡∏©
                
                // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥
                'entry.1141587732': document.querySelector('input[name="normalExamType"]:checked')?.value || '', // ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏™‡∏≠‡∏ö‡∏õ‡∏Å‡∏ï‡∏¥
                'entry.1756568616': document.getElementById('normal_rank')?.value || '', // ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö‡∏õ‡∏Å‡∏ï‡∏¥
                'entry.116385325': document.getElementById('score_normal_math')?.value || '', // ‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏õ‡∏Å‡∏ï‡∏¥
                'entry.1335384760': document.getElementById('score_normal_science')?.value || '', // ‡∏ß‡∏¥‡∏ó‡∏¢‡πå‡∏õ‡∏Å‡∏ï‡∏¥
                'entry.2020736175': document.getElementById('score_normal_english')?.value || '', // ‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©‡∏õ‡∏Å‡∏ï‡∏¥
                'entry.1380546567': document.getElementById('score_normal_thai')?.value || '', // ‡πÑ‡∏ó‡∏¢‡∏õ‡∏Å‡∏ï‡∏¥
                'entry.2108153379': document.getElementById('score_normal_social')?.value || '', // ‡∏™‡∏±‡∏á‡∏Ñ‡∏°‡∏õ‡∏Å‡∏ï‡∏¥
                
                // ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢
                'entry.1740443830': targetSpecial, // ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏û‡∏¥‡πÄ‡∏®‡∏©
                'entry.1321182613': targetNormal, // ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏õ‡∏Å‡∏ï‡∏¥
                
                // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°
                'entry.123456789': new Date().toLocaleString('th-TH') // ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á
            };
            
            // ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á Google Form
            const success = submitToGoogleForm(formData);
            
            if (success) {
                // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡∏∞‡∏ã‡πà‡∏≠‡∏ô‡∏ü‡∏≠‡∏£‡πå‡∏°
                document.getElementById('form-section').classList.add('hidden');
                document.getElementById('success-message').classList.remove('hidden');
            } else {
                showMessage("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà", "error");
            }
        }

        // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö
        document.addEventListener('DOMContentLoaded', function() {
            // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
            setupAutoCalculate();
            
            // ‡πÄ‡∏û‡∏¥‡πà‡∏° Event Listener ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
            document.querySelectorAll('.curriculum-option').forEach(option => {
                option.addEventListener('click', function() {
                    const radio = this.querySelector('input[type="radio"]');
                    radio.checked = true;
                    
                    // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ selected
                    document.querySelectorAll('.curriculum-option').forEach(opt => {
                        opt.classList.remove('selected');
                    });
                    this.classList.add('selected');
                    
                    // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£ Pre-test ‡πÉ‡∏´‡πâ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï‡∏ü‡∏≠‡∏£‡πå‡∏°
                    if (radio.name === 'pretestCurriculum') {
                        toggleExamTypeSelection();
                    }
                });
            });

            // ‡πÄ‡∏û‡∏¥‡πà‡∏° Event Listener ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ö
            document.querySelectorAll('.exam-type-option').forEach(option => {
                option.addEventListener('click', function() {
                    const radio = this.querySelector('input[type="radio"]');
                    radio.checked = true;
                    
                    // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ selected
                    document.querySelectorAll('.exam-type-option').forEach(opt => {
                        opt.classList.remove('selected');
                    });
                    this.classList.add('selected');
                });
            });

            // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏õ‡∏∏‡πà‡∏°‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï
            document.getElementById('reset-btn').addEventListener('click', resetForm);
            
            // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°
            document.getElementById('survey-form').addEventListener('submit', handleFormSubmit);
        });
    </script>
</body>
</html>
